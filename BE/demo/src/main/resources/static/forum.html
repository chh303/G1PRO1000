<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forum</title>

    <!-- CSS -->
    <link rel="stylesheet" href="css/forum.css">
    <link rel="stylesheet" href="css/header.css" />
    <link rel="stylesheet" href="css/footer.css" />
    <link rel="stylesheet" href="css/chatbot.css">

    <!-- JS -->
    <script src="/script/header.js" defer></script>
    <script src="/script/chatbot.js" defer></script>
    <script src="/script/footer.js" defer></script>

    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="forum-posts-container" id="forumPosts"></div>

    <!-- ðŸ”¹ Publiser innlegg-knapp -->
    <div class="post-button-container">
        <button id="newPostBtn" onclick="window.location.href='forumPost.html'">+ Nytt innlegg</button>
    </div>

    <div id="chatbot-placeholder"></div>

    <script>
        async function loadPosts() {
            const res = await fetch("/api/forum/all");
            const posts = await res.json();
            const container = document.getElementById("forumPosts");

            posts.forEach(post => {
                const div = document.createElement("div");
                div.classList.add("forum-post");
                div.innerHTML = `
                    <p><strong>Forfatter:</strong> ${post.author}</p>
                    <h3>${post.title}</h3>
                    <p>${post.content.length > 150 ? post.content.slice(0, 150) + "..." : post.content}</p>
                    <small><em>${new Date(post.timestamp).toLocaleString()}</em></small>
                `;
                div.addEventListener("click", () => {
                    window.location.href = `forumPostDetails.html?id=${post.id}`;
                });
                container.appendChild(div);
            });
        }

        loadPosts();
    </script>
</body>
</html>
